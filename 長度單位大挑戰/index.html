<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é•·åº¦å–®ä½å¤§æŒ‘æˆ°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap');
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f0f9ff;
        }
        .bounce {
            animation: bounce 2s infinite;
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
            40% {transform: translateY(-10px);}
            60% {transform: translateY(-5px);}
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <div id="game-container" class="max-w-md w-full bg-white rounded-3xl shadow-2xl p-8 border-4 border-blue-400 relative overflow-hidden">
        
        <!-- è£é£¾ç”¨å°åœ–ç¤º -->
        <div class="absolute top-2 right-2 opacity-10 text-6xl">ğŸ“</div>
        
        <!-- é¸æ“‡å¹´ç´šç•«é¢ -->
        <div id="start-screen" class="text-center">
            <h1 class="text-3xl font-bold text-blue-600 mb-4">é•·åº¦å–®ä½å¤§æŒ‘æˆ°</h1>
            <p class="text-gray-600 mb-8 font-medium">æŒ‘æˆ°ç›®æ¨™ï¼šç²å¾— 100 åˆ†ï¼</p>
            <div class="space-y-4">
                <button onclick="startGame(3)" class="w-full bg-orange-400 hover:bg-orange-500 text-white font-bold py-4 rounded-2xl shadow-lg transform transition active:scale-95 text-xl">
                    ä¸‰å¹´ç´š <br><span class="text-sm font-normal">(æ¯«ç±³ã€å…¬åˆ†ã€å…¬å°º)</span>
                </button>
                <button onclick="startGame(4)" class="w-full bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-4 rounded-2xl shadow-lg transform transition active:scale-95 text-xl">
                    å››ã€äº”å¹´ç´š <br><span class="text-sm font-normal">(å« å…¬é‡Œ æŒ‘æˆ°)</span>
                </button>
            </div>
        </div>

        <!-- éŠæˆ²é€²è¡Œç•«é¢ -->
        <div id="quiz-screen" class="hidden">
            <div class="flex justify-between items-center mb-6">
                <div class="flex flex-col">
                    <div id="grade-badge" class="text-xs text-blue-500 font-bold mb-1">æ¨¡å¼è¼‰å…¥ä¸­</div>
                    <div class="text-sm text-gray-500 font-medium">
                        é€²åº¦ï¼šç¬¬ <span id="current-index">1</span> é¡Œ
                    </div>
                </div>
                <div class="flex flex-col items-end">
                    <div class="text-xs text-green-600 font-bold mb-1">ç›®æ¨™ï¼š100 åˆ†</div>
                    <div class="bg-green-100 px-4 py-2 rounded-full text-green-700 font-bold shadow-sm">
                        <span id="score">0</span> åˆ†
                    </div>
                </div>
            </div>

            <!-- åˆ†æ•¸é€²åº¦æ¢ -->
            <div class="w-full bg-gray-200 rounded-full h-2.5 mb-6">
                <div id="score-progress" class="bg-green-500 h-2.5 rounded-full transition-all duration-500" style="width: 0%"></div>
            </div>

            <div id="question-box" class="bg-yellow-50 rounded-2xl p-6 mb-8 border-2 border-yellow-200 text-center min-h-[140px] flex flex-col justify-center">
                <h2 id="question-text" class="text-xl font-bold text-gray-800 mb-1"></h2>
                <p id="question-hint" class="text-4xl font-black text-blue-600"></p>
            </div>

            <div id="options-grid" class="grid grid-cols-2 gap-4">
                <!-- æŒ‰éˆ•ç”± JS å‹•æ…‹ç”Ÿæˆ -->
            </div>

            <div id="feedback" class="mt-6 text-center h-8 font-bold text-lg"></div>
        </div>

        <!-- çµç®—ç•«é¢ -->
        <div id="result-screen" class="hidden text-center">
            <div class="text-6xl mb-4 bounce">ğŸ†</div>
            <h2 class="text-3xl font-bold text-blue-600 mb-2">æ­å–œé”æˆç›®æ¨™ï¼</h2>
            <div class="bg-blue-50 rounded-2xl p-6 mb-8 border-2 border-blue-100">
                <p class="text-lg text-gray-700">æœ€çµ‚å¾—åˆ†</p>
                <p class="text-6xl font-black text-blue-600"><span id="final-score">100</span></p>
                <p id="stats-text" class="mt-4 text-sm text-gray-500"></p>
            </div>
            
            <button onclick="showStartScreen()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-10 rounded-full shadow-lg transition duration-200">
                å†ç©ä¸€æ¬¡
            </button>
        </div>
    </div>

    <script>
        const allQuestions = {
            3: [
                { item: "ä¸€æšç¡¬å¹£çš„åšåº¦", value: 2, unit: "æ¯«ç±³" },
                { item: "å½©è‰²ç­†çš„é•·åº¦", value: 15, unit: "å…¬åˆ†" },
                { item: "æ•™å®¤çš„é«˜åº¦", value: 3, unit: "å…¬å°º" },
                { item: "æ©¡çš®æ“¦çš„é•·åº¦", value: 5, unit: "å…¬åˆ†" },
                { item: "ä¸€éš»èèŸ»çš„èº«é•·", value: 6, unit: "æ¯«ç±³" },
                { item: "é»‘æ¿çš„é•·åº¦", value: 4, unit: "å…¬å°º" },
                { item: "æ ¡é–€å£åˆ°æ•™å®¤è·é›¢", value: 50, unit: "å…¬å°º" },
                { item: "é‰›ç­†ç›’çš„åšåº¦", value: 3, unit: "å…¬åˆ†" },
                { item: "å°èºçµ²é‡˜çš„é•·åº¦", value: 8, unit: "æ¯«ç±³" },
                { item: "æ¸¸æ³³æ± çš„é•·åº¦", value: 25, unit: "å…¬å°º" },
                { item: "æ‰‹æ©Ÿçš„å¯¬åº¦", value: 7, unit: "å…¬åˆ†" },
                { item: "è¡›ç”Ÿç´™ç›’çš„é«˜åº¦", value: 9, unit: "å…¬åˆ†" },
                { item: "è¿´ç´‹é‡çš„é•·åº¦", value: 30, unit: "æ¯«ç±³" },
                { item: "èº«é«˜å¤§ç´„æ˜¯ 140", value: 140, unit: "å…¬åˆ†" },
                { item: "å…¬è»Šçš„é•·åº¦", value: 12, unit: "å…¬å°º" },
                { item: "ä¸€å…ƒç¡¬å¹£çš„ç›´å¾‘", value: 20, unit: "æ¯«ç±³" },
                { item: "è† æ°´ç“¶çš„é«˜åº¦", value: 12, unit: "å…¬åˆ†" },
                { item: "å°è²“çš„èº«é•·", value: 30, unit: "å…¬åˆ†" },
                { item: "æ›¸æ¡Œçš„å¯¬åº¦", value: 60, unit: "å…¬åˆ†" },
                { item: "é›»ç·šæ¡¿çš„é«˜åº¦", value: 10, unit: "å…¬å°º" },
                { item: "è¨‚æ›¸é‡çš„å¯¬åº¦", value: 12, unit: "æ¯«ç±³" },
                { item: "è‡ªå‹•ç­†èŠ¯çš„ç²—ç´°", value: 0.5, unit: "æ¯«ç±³" },
                { item: "ç±ƒçƒå ´çš„é•·åº¦", value: 28, unit: "å…¬å°º" },
                { item: "é•·å°ºçš„é•·åº¦", value: 30, unit: "å…¬åˆ†" },
                { item: "ä¸€æ£µå¤§æ¨¹çš„é«˜åº¦", value: 15, unit: "å…¬å°º" }
            ],
            4: [
                { item: "åœ‹é“ä¸€è™Ÿå…¬è·¯é•·åº¦", value: 374, unit: "å…¬é‡Œ" },
                { item: "å°åŒ—101å¤§æ¨“é«˜åº¦", value: 508, unit: "å…¬å°º" },
                { item: "æ‰‹æ©Ÿçš„åšåº¦", value: 9, unit: "æ¯«ç±³" },
                { item: "é¦¬æ‹‰æ¾æ¯”è³½è·é›¢", value: 42, unit: "å…¬é‡Œ" },
                { item: "èª²æ¡Œæ¤…çš„é«˜åº¦", value: 75, unit: "å…¬åˆ†" },
                { item: "ç‰å±±çš„é«˜åº¦", value: 3952, unit: "å…¬å°º" },
                { item: "å°åŒ—åˆ°é«˜é›„çš„è·é›¢", value: 350, unit: "å…¬é‡Œ" },
                { item: "èª²æœ¬çš„åšåº¦", value: 1, unit: "å…¬åˆ†" },
                { item: "ä¸€èˆ¬è¨‚æ›¸é‡çš„å¯¬åº¦", value: 12, unit: "æ¯«ç±³" },
                { item: "ç”°å¾‘å ´è·‘é“ä¸€åœˆ", value: 400, unit: "å…¬å°º" },
                { item: "æ·é‹è»Œé“çš„å¯¬åº¦", value: 1435, unit: "æ¯«ç±³" },
                { item: "å°ç£å—åŒ—çš„é•·åº¦", value: 394, unit: "å…¬é‡Œ" },
                { item: "è‡ªè¡Œè»Šé“çš„ç¸½é•·", value: 15, unit: "å…¬é‡Œ" },
                { item: "æ——æ¡¿çš„é«˜åº¦", value: 12, unit: "å…¬å°º" },
                { item: "ä¸€æ ¹ç«æ¯›çš„é•·åº¦", value: 8, unit: "æ¯«ç±³" },
                { item: "ç™»å±±æ­¥é“çš„å…¨é•·", value: 3500, unit: "å…¬å°º" },
                { item: "è˜‡èŠ±å…¬è·¯é•·åº¦", value: 118, unit: "å…¬é‡Œ" },
                { item: "æŒ‡ç”²ç”Ÿé•·ä¸€å€‹æœˆç´„", value: 3, unit: "æ¯«ç±³" },
                { item: "ä¸€å¼µæ‚ éŠå¡çš„åšåº¦", value: 1, unit: "æ¯«ç±³" },
                { item: "è²¨æ«ƒè»Šçš„é•·åº¦", value: 12, unit: "å…¬å°º" },
                { item: "åœ°çƒèµ¤é“çš„å‘¨é•·", value: 40075, unit: "å…¬é‡Œ" },
                { item: "æ²³é‚Šæ­¥é“çš„å¯¬åº¦", value: 4, unit: "å…¬å°º" },
                { item: "é¤æ¡Œçš„é•·åº¦", value: 180, unit: "å…¬åˆ†" },
                { item: "ç­†è¨˜å‹é›»è…¦è¢å¹•", value: 35, unit: "å…¬åˆ†" },
                { item: "ä¸€æ ¹é ­é«®çš„ç›´å¾‘", value: 0.1, unit: "æ¯«ç±³" }
            ]
        };

        const unitsByGrade = {
            3: ["æ¯«ç±³", "å…¬åˆ†", "å…¬å°º"],
            4: ["æ¯«ç±³", "å…¬åˆ†", "å…¬å°º", "å…¬é‡Œ"]
        };

        let currentGrade = 3;
        let poolQuestions = [];
        let currentIndex = 0;
        let score = 0;
        let totalAnswered = 0;

        const startScreen = document.getElementById('start-screen');
        const quizScreen = document.getElementById('quiz-screen');
        const resultScreen = document.getElementById('result-screen');

        function showStartScreen() {
            startScreen.classList.remove('hidden');
            quizScreen.classList.add('hidden');
            resultScreen.classList.add('hidden');
        }

        function startGame(grade) {
            currentGrade = grade;
            // é¡Œåº«éš¨æ©Ÿæ’åº
            poolQuestions = [...allQuestions[grade]].sort(() => Math.random() - 0.5);
            
            currentIndex = 0;
            score = 0;
            totalAnswered = 0;
            
            startScreen.classList.add('hidden');
            quizScreen.classList.remove('hidden');
            resultScreen.classList.add('hidden');
            
            document.getElementById('grade-badge').innerText = grade === 3 ? "ä¸‰å¹´ç´šæ¨¡å¼" : "å››äº”å¹´ç´šæ¨¡å¼";
            updateUI();
            showQuestion();
        }

        function showQuestion() {
            const feedback = document.getElementById('feedback');
            feedback.innerText = "";
            
            // å¦‚æœé¡Œåº«ç”¨å®Œäº†ï¼Œé‡æ–°æ´—ç‰Œ
            if (currentIndex >= poolQuestions.length) {
                poolQuestions.sort(() => Math.random() - 0.5);
                currentIndex = 0;
            }

            const q = poolQuestions[currentIndex];
            
            document.getElementById('current-index').innerText = totalAnswered + 1;
            document.getElementById('question-text').innerText = q.item;
            document.getElementById('question-hint').innerText = q.value;

            const grid = document.getElementById('options-grid');
            grid.innerHTML = "";
            
            const currentUnits = unitsByGrade[currentGrade];
            currentUnits.forEach(unit => {
                const btn = document.createElement('button');
                btn.className = "bg-white hover:bg-blue-50 border-2 border-blue-200 rounded-xl py-4 font-bold text-gray-700 transition duration-200 shadow-sm active:bg-blue-100";
                btn.innerText = unit;
                btn.dataset.unit = unit;
                btn.onclick = () => checkAnswer(unit, btn);
                grid.appendChild(btn);
            });
        }

        function checkAnswer(selectedUnit, clickedBtn) {
            const correctAnswer = poolQuestions[currentIndex].unit;
            const feedback = document.getElementById('feedback');
            const buttons = document.querySelectorAll('#options-grid button');
            
            buttons.forEach(btn => btn.disabled = true);
            totalAnswered++;

            if (selectedUnit === correctAnswer) {
                score += 4;
                updateUI();
                clickedBtn.classList.remove('bg-white', 'hover:bg-blue-50', 'border-blue-200');
                clickedBtn.classList.add('bg-green-500/50', 'border-green-500', 'text-green-800');
                feedback.innerText = "â­ å¤ªæ£’äº†ï¼ç­”å°äº†ï¼";
                feedback.className = "mt-6 text-center h-8 font-bold text-lg text-green-500";
            } else {
                buttons.forEach(btn => {
                    if (btn.dataset.unit === correctAnswer) {
                        btn.classList.remove('bg-white', 'hover:bg-blue-50', 'border-blue-200');
                        btn.classList.add('bg-green-500/50', 'border-green-500', 'text-green-800');
                    } else if (btn === clickedBtn) {
                        btn.classList.remove('bg-white', 'hover:bg-blue-50', 'border-blue-200');
                        btn.classList.add('bg-red-500/50', 'border-red-500', 'text-red-800');
                    }
                });
                feedback.innerText = `âŒ æ­£ç¢ºç­”æ¡ˆæ˜¯ã€Œ${correctAnswer}ã€`;
                feedback.className = "mt-6 text-center h-8 font-bold text-lg text-red-500";
            }

            setTimeout(() => {
                if (score >= 100) {
                    endGame();
                } else {
                    currentIndex++;
                    showQuestion();
                }
            }, 1200);
        }

        function updateUI() {
            document.getElementById('score').innerText = score;
            const progress = Math.min(score, 100);
            document.getElementById('score-progress').style.width = `${progress}%`;
        }

        function endGame() {
            quizScreen.classList.add('hidden');
            resultScreen.classList.remove('hidden');
            document.getElementById('final-score').innerText = score;
            document.getElementById('stats-text').innerText = `ä½ ä¸€å…±æŒ‘æˆ°äº† ${totalAnswered} é¡Œä¾†é”æˆç›®æ¨™ï¼`;
        }
    </script>
</body>
</html>
